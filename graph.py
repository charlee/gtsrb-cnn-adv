import numpy as np
import matplotlib.pyplot as plt


cgtsrb10 = {
    'mis': [0.737817433081674, 0.894844656879481, 0.963979416809605, 0.988725657669969, 0.998971193415637, 0.999657885733835],
    'tgt': [0.54118050789293, 0.662342096278593, 0.703945111492281, 0.714724974376494, 0.74039780521262, 0.729729729729729],
    'adv1 mis': [0.35630599586492, 0.30813953488372, 0.390310474240873, 0.403544648943421, 0.40245985650837, 0.401642148477591],
    'adv1 tgt': [0.107167470709855, 0.088235294117647, 0.0883657454793585, 0.0794137695978186, 0.0666211137683635, 0.0492644543277454],
    'adv2 mis': [0.449829351535836, 0.332757429163787, 0.331060347766791, 0.342896647079156, 0.349726775956284, 0.345759233926128],
    'adv2 tgt': [0.144368600682593, 0.0808569454042847, 0.0934197067848619, 0.085378499827169, 0.0741120218579235, 0.0738714090287277],
    'adv3 mis': [0.405515832482124, 0.314884840151254, 0.345849121598346, 0.340273037542662, 0.322291235334713, 0.315897435897435],
    'adv3 tgt': [0.13210759278175, 0.0818150567205225, 0.0850843954529796, 0.0675767918088737, 0.0583160800552104, 0.0482051282051282],
}

cifar10 = {
    'mis': [0.990697674418604, 0.988879003558718, 0.979777777777777, 0.973936288705725, 0.967799244947812, 0.958861463197687],
    'tgt': [0.883499446290144, 0.7769128113879, 0.568, 0.406994876364446, 0.322007550521874, 0.244162775183455],
    'adv1 mis': [0.770502645502645, 0.326435246995994, 0.344690265486725, 0.408637873754152, 0.508697591436217, 0.580967169476486],
    'adv1 tgt': [0.40542328042328, 0.00222518914107699, 0.00132743362831858, 0.00177187153931339, 0.0031222123104371, 0.00798580301685891],
    'adv2 mis': [0.682342502218278, 0.312402234636871, 0.331775700934579, 0.411385368023126, 0.509933774834437, 0.598488216985326],
    'adv2 tgt': [0.336734693877551, 0.00312849162011173, 0.00178015131286159, 0.00200133422281521, 0.00640176600441501, 0.0108937305469097],
    'adv3 mis': [0.654508838666368, 0.312989045383411, 0.340293203020879, 0.448709463931171, 0.572561109887689, 0.665107993765308],
    'adv3 tgt': [0.323338554486462, 0.00424770847306058, 0.00288760550866281, 0.00639752923009044, 0.0103501431402774, 0.0184814072589623],
}



fmnist = {
    'mis': [0.771836007130124, 0.95877659574468, 0.98231262436436, 0.985014538134645, 0.983982202447163, 0.988457269700333],
    'tgt': [0.423351158645276, 0.600398936170212, 0.615741764315719, 0.583762021919033, 0.508342602892102, 0.446836847946725],
    'adv1 mis': [0.322030141843971, 0.152188552188552, 0.291203909373611, 0.469184890656063, 0.583463338533541, 0.666290358997516],
    'adv1 tgt': [0.0828900709219858, 0.0161616161616161, 0.0173256330519769, 0.0229732714822178, 0.0396701582349008, 0.0623165500112892],
    'adv2 mis': [0.264856443356332, 0.148131672597864, 0.36472148541114, 0.53762486126526, 0.64650033119894, 0.719566179725542],
    'adv2 tgt': [0.0572000890273759, 0.0097864768683274, 0.0203359858532272, 0.0379578246392896, 0.0485758445572974, 0.0582115980522355],
    'adv3 mis': [0.247663551401869, 0.108937305469097, 0.239508928571428, 0.508693713776192, 0.668003565062388, 0.736643759698514],
    'adv3 tgt': [0.0529595015576324, 0.00800355713650511, 0.0125, 0.0287561301827909, 0.0363190730837789, 0.0434493460430059],
}


mnistbg = {
    'mis': [0.874222222222222, 0.995073891625615, 0.999555259061596, 0.998669917978275, 0.997341014846, 0.990633363068688],
    'tgt': [0.752444444444444, 0.937975817286162, 0.92772959750945, 0.839946796719131, 0.716153334810547, 0.568688670829616],
    'adv1 mis': [0.528651059085841, 0.336746049410193, 0.406421816582362, 0.559858375746846, 0.708936928905727, 0.81520053179703],
    'adv1 tgt': [0.26711259754738, 0.0489650567549521, 0.0483835495931383, 0.0601903075901748, 0.0911522175172721, 0.111455794371814],
    'adv2 mis': [0.499222395023328, 0.31340620120455, 0.443404634581105, 0.621131741821397, 0.741371681415929, 0.827517226050233],
    'adv2 tgt': [0.249722283936902, 0.0401516841400847, 0.053475935828877, 0.0839964633068081, 0.111946902654867, 0.145143365192264],
    'adv3 mis': [0.514056224899598, 0.336147522772717, 0.502647837599293, 0.694967856351141, 0.800089345543891, 0.858849557522123],
    'adv3 tgt': [0.246987951807228, 0.0484336814041324, 0.0695057369814651, 0.113056971846597, 0.1364753182935, 0.162831858407079],
}


mnist = {
    'mis': [0.209150326797385, 0.751121076233183, 0.984615384615384, 1, 1, 0.99562363238512],
    'tgt': [0.132897603485838, 0.513452914798206, 0.742857142857142, 0.733031674208144, 0.702947845804988, 0.588621444201312],
    'adv1 mis': [0.081985375581653, 0.0635838150289017, 0.26442414791713, 0.540834442964935, 0.667111704494882, 0.727697441601779],
    'adv1 tgt': [0.0128517615776645, 0.00733659404179635, 0.0213856092670973, 0.0563692853972481, 0.0785491766800178, 0.0829810901001112],
    'adv2 mis': [0.0350915912602074, 0.0399290150842945, 0.206781914893617, 0.438194753223655, 0.59375, 0.649413846494138],
    'adv2 tgt': [0.00463473846832928, 0.00266193433895297, 0.00554078014184397, 0.0200088928412627, 0.0285904255319148, 0.0307454103074541],
    'adv3 mis': [0.0396105333038282, 0.0284128745837957, 0.123220640569395, 0.318202146690518, 0.515687140963323, 0.57631637413908],
    'adv3 tgt': [0.00442575791104226, 0.00110987791342952, 0.00111209964412811, 0.00916815742397137, 0.01480335837384, 0.0137747167296156],
}

labels = [
    'mis',
    'tgt',
    'adv1 mis',
    'adv1 tgt',
    'adv2 mis',
    'adv2 tgt',
    'adv3 mis',
    'adv3 tgt',
]

def draw_bargraph(data, title, filename):
    num_groups = 8
    bar_width = 0.125
    colors = ['r', 'g', 'b', 'c', 'y', 'm']
    fig, ax = plt.subplots()

    ax.set_ylabel('Success Rate')
    ax.set_title(title)

    index = np.arange(num_groups)

    for i in range(6):
        bar_data = [data[label][i] for label in labels]
        plt.bar(index + i * bar_width, bar_data,
                bar_width, alpha=1, color=colors[i], label='{}'.format((i+1) / 10))

    locs, lbls = plt.xticks(index + bar_width * 2, labels)
    plt.setp(lbls, rotation=20)
    plt.legend()

    fig.savefig(filename)

draw_bargraph(cgtsrb10, 'CGTSRB10 Success Rate', 'docs/sucrate-cgtsrb10.png')
draw_bargraph(cifar10, 'CIFAR10 Success Rate', 'docs/sucrate-cifar10.png')
draw_bargraph(fmnist, 'FMNIST Success Rate', 'docs/sucrate-fmnist.png')
draw_bargraph(mnistbg, 'MNISTBG Success Rate', 'docs/sucrate-mnistbg.png')
draw_bargraph(mnist, 'MNIST Success Rate', 'docs/sucrate-mnist.png')
